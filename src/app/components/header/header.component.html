<div class="header-container">
  <!-- Mobile Header (only visible on mobile) -->
  <div class="d-flex flex-row align-items-center justify-content-between ps-4 pb-4 d-flex d-md-none">
    <div class="d-flex flex-row align-items-center">
      <!-- Sidebar Toggle Button (mobile only) -->
      <button
        class="btn btn-link me-2 sidebar-toggle"
        (click)="toggleSidebar()"
        aria-label="Toggle sidebar">
        <i class="fas" [ngClass]="sidebarOpen ? 'fa-chevron-left' : 'fa-bars'"></i>
      </button>
      <!-- Logo and Brand -->
      <div class="d-flex flex-row gap-3 align-items-center">
        <div class="logo-container">
          <img src="assets/logo.png" alt="Logo" class="logo">
        </div>
        <div class="d-flex flex-column">
          <span class="brand-name">Elisha-Fit</span>
          <span class="brand-subtitle">Premium Fitness Tracker</span>
        </div>
      </div>
    </div>

    <!-- Mobile User Actions -->
    <div class="d-flex flex-row align-items-center gap-2">
      <!-- Notifications -->
      <div class="position-relative">
        <button
          class="btn btn-link notification-btn"
          (click)="toggleNotifications()"
          aria-label="Notifications">
          <i class="fas fa-bell"></i>
          <span *ngIf="unreadNotificationsCount > 0" class="notification-badge">
            {{ unreadNotificationsCount }}
          </span>
        </button>
        
        <!-- Notifications Dropdown -->
        <div *ngIf="showNotifications" class="notification-dropdown">
          <div class="notification-header">
            <h6 class="mb-0">Notifications</h6>
            <button class="btn btn-link btn-sm" (click)="showNotifications = false">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="notification-list">
            <div 
              *ngFor="let notification of notifications" 
              class="notification-item"
              [class.unread]="!notification.read"
              (click)="markNotificationAsRead(notification.id)">
              <div class="notification-content">
                <p class="notification-message">{{ notification.message }}</p>
                <small class="notification-time">{{ notification.time }}</small>
              </div>
              <div *ngIf="!notification.read" class="notification-indicator"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- User Menu -->
      <div class="position-relative">
        <button
          class="btn btn-link user-menu-btn"
          (click)="toggleUserMenu()"
          aria-label="User menu">
          <div class="user-avatar">
            {{ userInitials }}
          </div>
        </button>
        
        <!-- User Dropdown -->
        <div *ngIf="showUserMenu" class="user-dropdown">
          <div class="user-info">
            <div class="user-avatar-large">
              {{ userInitials }}
            </div>
            <div class="user-details">
              <h6 class="user-name">{{ currentUser?.name || 'User' }}</h6>
              <small class="user-email">{{ currentUser?.email || 'user@example.com' }}</small>
            </div>
          </div>
          <div class="dropdown-divider"></div>
          <div class="dropdown-menu">
            <button class="dropdown-item" (click)="navigateToProfile()">
              <i class="fas fa-user"></i> Profile
            </button>
            <button class="dropdown-item" (click)="navigateToSettings()">
              <i class="fas fa-cog"></i> Settings
            </button>
            <div class="dropdown-divider"></div>
            <button class="dropdown-item text-danger" (click)="logout()">
              <i class="fas fa-sign-out-alt"></i> Logout
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Desktop Header (only visible on desktop) -->
  <div class="d-none d-md-flex flex-row align-items-center justify-content-between px-4 py-3">
    <!-- Left Section: Logo and Navigation -->
    <div class="d-flex flex-row align-items-center gap-4">
      <!-- Logo and Brand -->
      <div class="d-flex flex-row gap-3 align-items-center">
        <div class="logo-container">
          <img src="assets/logo.png" alt="Logo" class="logo">
        </div>
        <div class="d-flex flex-column">
          <span class="brand-name">Elisha-Fit</span>
          <span class="brand-subtitle">Premium Fitness Tracker</span>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="quick-actions d-flex flex-row gap-2">
        <button class="btn btn-fitness btn-sm" routerLink="/program-wizard">
          <i class="fas fa-plus"></i> New Program
        </button>
        <button class="btn btn-primary ms-3" routerLink="/start-workout">
          <i class="fas fa-play me-1"></i> Start Workout
        </button>
      </div>
    </div>

    <!-- Right Section: User Actions -->
    <div class="d-flex flex-row align-items-center gap-3">
      <!-- Notifications -->
      <div class="position-relative">
        <button
          class="btn btn-link notification-btn"
          (click)="toggleNotifications()"
          aria-label="Notifications">
          <i class="fas fa-bell"></i>
          <span *ngIf="unreadNotificationsCount > 0" class="notification-badge">
            {{ unreadNotificationsCount }}
          </span>
        </button>
        
        <!-- Notifications Dropdown -->
        <div *ngIf="showNotifications" class="notification-dropdown">
          <div class="notification-header">
            <h6 class="mb-0">Notifications</h6>
            <button class="btn btn-link btn-sm" (click)="showNotifications = false">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="notification-list">
            <div 
              *ngFor="let notification of notifications" 
              class="notification-item"
              [class.unread]="!notification.read"
              (click)="markNotificationAsRead(notification.id)">
              <div class="notification-content">
                <p class="notification-message">{{ notification.message }}</p>
                <small class="notification-time">{{ notification.time }}</small>
              </div>
              <div *ngIf="!notification.read" class="notification-indicator"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- User Menu -->
      <div class="position-relative">
        <button
          class="btn btn-link user-menu-btn"
          (click)="toggleUserMenu()"
          aria-label="User menu">
          <div class="user-avatar">
            {{ userInitials }}
          </div>
          <span class="user-name-text">{{ currentUser?.name || 'User' }}</span>
          <i class="fas fa-chevron-down"></i>
        </button>
        
        <!-- User Dropdown -->
        <div *ngIf="showUserMenu" class="user-dropdown">
          <div class="user-info">
            <div class="user-avatar-large">
              {{ userInitials }}
            </div>
            <div class="user-details">
              <h6 class="user-name">{{ currentUser?.name || 'User' }}</h6>
              <small class="user-email">{{ currentUser?.email || 'user@example.com' }}</small>
            </div>
          </div>
          <div class="dropdown-divider"></div>
          <div class="dropdown-menu">
            <button class="dropdown-item" (click)="navigateToProfile()">
              <i class="fas fa-user"></i> Profile
            </button>
            <button class="dropdown-item" (click)="navigateToSettings()">
              <i class="fas fa-cog"></i> Settings
            </button>
            <div class="dropdown-divider"></div>
            <button class="dropdown-item text-danger" (click)="logout()">
              <i class="fas fa-sign-out-alt"></i> Logout
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Logout Confirmation Dialog -->
  <app-confirm-dialog
    [isVisible]="showLogoutDialog"
    [data]="{
      title: 'Confirm Logout',
      message: 'Are you sure you want to logout? You will be redirected to the login page.',
      confirmText: 'Logout',
      cancelText: 'Cancel',
      type: 'warning',
      showIcon: true
    }"
    (confirm)="confirmLogout()"
    (cancel)="cancelLogout()"
    (close)="cancelLogout()">
  </app-confirm-dialog>
</div>
